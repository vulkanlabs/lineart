FROM python:3.12-slim

WORKDIR /opt

RUN pip install uv
RUN mkdir /opt/dependencies

{% if dependencies|length > 0 %}
COPY \ {% for dependency in dependencies -%}
{{ dependency.name }} \
{% endfor -%}
    /opt/dependencies/
{% endif %}

COPY {{ policy.name }} /opt/policy/
RUN uv pip install --system --no-cache /opt/policy {% if dependencies|length > 0 %} \ {% endif %}
{%- for dependency in dependencies -%}
/opt/dependencies/{{ dependency.name }} {% if not loop.last %} {% endif %}
{%- endfor -%}