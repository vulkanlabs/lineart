FROM {{ base_image }}

{% for dependency in dependencies %}
COPY {{ dependency.name }} /opt/dependencies/{{ dependency.name }}
{% endfor -%}

COPY {{ policy.name }} /opt/policy/
RUN uv pip install --system --no-cache \    
    /opt/policy {% if dependencies|length > 0 %} \ {% endif %}
{%- for dependency in dependencies -%}
/opt/dependencies/{{ dependency.name }} {% if not loop.last %} {% endif %}
{%- endfor %}
